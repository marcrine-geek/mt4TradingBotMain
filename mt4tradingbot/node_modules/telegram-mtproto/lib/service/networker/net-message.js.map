{"version":3,"sources":["../../../src/service/networker/net-message.js"],"names":["NetMessage","constructor","seq_no","body","acked","msg_id","container","deferred","copyHelper","value","key","copyOptions","options","size","Uint8Array","byteLength","length","NetContainer","inner"],"mappings":";;;;;;;AAEA;;;;AAEA;;AACA;;;;;;AAIO,MAAMA,UAAN,CAAiB;AAQtBC,cAAYC,MAAZ,EAA4BC,IAA5B,EAA6C;AAAA,SAJ7CC,KAI6C,GAJ5B,KAI4B;AAAA,SAH7CC,MAG6C,GAH5B,8BAG4B;AAAA,SAF7CC,SAE6C,GAFxB,KAEwB;AAAA,SAD7CC,QAC6C,GADlC,sBACkC;;AAAA,SAO7CC,UAP6C,GAOhC,CAACC,KAAD,EAAaC,GAAb,KAA6B;AACxC;AACA,WAAKA,GAAL,IAAYD,KAAZ;AACD,KAV4C;;AAC3C,SAAKP,MAAL,GAAcA,MAAd;AACA,SAAKC,IAAL,GAAYA,IAAZ;AACD;AACDQ,cAAYC,OAAZ,EAA6B;AAAE;AAC7B,qCAAkB,KAAKJ,UAAvB,EAAmCI,OAAnC;AACD;;AAKDC,SAAO;AACL,QAAI,KAAKV,IAAL,YAAqBW,UAAzB,EACE,OAAO,KAAKX,IAAL,CAAUY,UAAjB,CADF,KAGE,OAAO,KAAKZ,IAAL,CAAUa,MAAjB;AACH;AAxBqB;;QAAXhB,U,GAAAA,U;AA2BN,MAAMiB,YAAN,SAA2BjB,UAA3B,CAAsC;AAE3CC,cAAYC,MAAZ,EAA4BC,IAA5B,EAA6Ce,KAA7C,EAA8D;AAC5D,UAAMhB,MAAN,EAAcC,IAAd;AACA,SAAKG,SAAL,GAAiB,IAAjB;AACA,SAAKY,KAAL,GAAaA,KAAb;AACD;AAN0C;QAAhCD,Y,GAAAA,Y","file":"net-message.js","sourcesContent":["//@flow\r\n\r\nimport forEachObjIndexed from 'ramda/src/forEachObjIndexed'\r\n\r\nimport { generateID } from '../time-manager'\r\nimport blueDefer from '../../util/defer'\r\n\r\ntype BodyBytes = number[] | Uint8Array\r\n\r\nexport class NetMessage {\r\n  body: BodyBytes\r\n  seq_no: number\r\n  isAPI: boolean\r\n  acked: boolean = false\r\n  msg_id: string = generateID()\r\n  container: boolean = false\r\n  deferred = blueDefer()\r\n  constructor(seq_no: number, body: BodyBytes) {\r\n    this.seq_no = seq_no\r\n    this.body = body\r\n  }\r\n  copyOptions(options: Object) { //TODO remove this\r\n    forEachObjIndexed(this.copyHelper, options)\r\n  }\r\n  copyHelper = (value: any, key: string) => {\r\n    //$FlowIssue\r\n    this[key] = value\r\n  }\r\n  size() {\r\n    if (this.body instanceof Uint8Array)\r\n      return this.body.byteLength\r\n    else\r\n      return this.body.length\r\n  }\r\n}\r\n\r\nexport class NetContainer extends NetMessage {\r\n  inner: string[]\r\n  constructor(seq_no: number, body: BodyBytes, inner: string[]) {\r\n    super(seq_no, body)\r\n    this.container = true\r\n    this.inner = inner\r\n  }\r\n}\r\n"]}